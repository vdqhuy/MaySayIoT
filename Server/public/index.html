<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Gateway Dashboard</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    .card { background: #f2f2f2; padding: 20px; border-radius: 10px; width: 300px; }
    .status { font-size: 24px; margin-bottom: 10px; }
    input[type=number] { width: 80px; }
    button { margin-top: 10px; }
  </style>
</head>
<body>

  <h2>üå°Ô∏è Gateway Dashboard</h2>
  <div class="card">
    <div class="status">
      Nhi·ªát ƒë·ªô: <span id="temp">--</span> ¬∞C
    </div>
    <div class="status">
      Qu·∫°t: <span id="fan">--</span>
    </div>
    <div>
      Ng∆∞·ª°ng nhi·ªát ƒë·ªô: <span id="threshold">--</span> ¬∞C
    </div>
    <div>
      <input type="number" id="newThreshold" placeholder="Nh·∫≠p ng∆∞·ª°ng m·ªõi" />
      <button onclick="updateThreshold()">C·∫≠p nh·∫≠t</button>
    </div>
  </div>

<script>
async function fetchStatus() {
  const res = await fetch('/status');
  const data = await res.json();
  document.getElementById('temp').innerText = data.temperature;
  document.getElementById('fan').innerText = data.fanStatus;
  document.getElementById('threshold').innerText = data.threshold;
}

async function updateThreshold() {
  const newThreshold = document.getElementById('newThreshold').value;
  if (newThreshold) {
    await fetch('/set-threshold', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ threshold: parseInt(newThreshold) })
    });
    alert("C·∫≠p nh·∫≠t ng∆∞·ª°ng th√†nh c√¥ng!");
    fetchStatus();
  }
}

setInterval(fetchStatus, 3000); // c·∫≠p nh·∫≠t m·ªói 3s
fetchStatus();
</script>

</body>
</html>
